#======================================================================
# TGA to MegaDrive
#======================================================================

#======================================================================
# -------------------------------------------------
# Subs
# -------------------------------------------------

def get_val(string_in):
  got_this_str=""
  for do_loop_for in string_in:
    got_this_str = got_this_str + ("0"+((hex(ord(do_loop_for)))[2:]))[-2:]
  return(got_this_str)

#======================================================================
# -------------------------------------------------
# Settings
# -------------------------------------------------

# -------------------------------------------------
# Init
# -------------------------------------------------

#======================================================================
# -------------------------------------------------
# Start
# -------------------------------------------------

input_file = open("MAIN.SMS","r+b")

#======================================================================
# -------------------------------------------------
# The best part
# -------------------------------------------------

the_result = 0
byte = 0
reading = 0x40000
input_file.seek(0)

while reading:
  byte = int(get_val(input_file.read(1)),16) & 0xFF
  the_result += byte
  
  reading -= 1
  
#======================================================================

rom_chks = the_result & 0xFFFF
print "its:",hex(rom_chks)

input_file.seek(0x7FFA)
input_file.write( chr(int(rom_chks)&0xFF) + chr(int((rom_chks&0xFF00)>>8)&0xFF) )

input_file.close()
